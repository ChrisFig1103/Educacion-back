import{r as n,b2 as e}from"./vendor-fa701907.js";import{A as a,S as Z,Q as $,E as ee,a as te,b as h,c as se,d as oe,e as ne}from"./index-757b271b.js";import{f as ae,d as ie,D as re,g as le,T as u,e as ce,C as N}from"./fluentui-react-d7f0d25c.js";import"./fluentui-icons-7028232d.js";const pe="_oneshotContainer_1x7b2_1",he="_oneshotTopSection_1x7b2_15",ue="_oneshotBottomSection_1x7b2_29",me="_oneshotTitle_1x7b2_49",de="_oneshotQuestionInput_1x7b2_77",xe="_oneshotAnswerContainer_1x7b2_91",Se="_oneshotAnalysisPanel_1x7b2_105",ge="_oneshotSettingsSeparator_1x7b2_115",Ce="_settingsButton_1x7b2_123",o={oneshotContainer:pe,oneshotTopSection:he,oneshotBottomSection:ue,oneshotTitle:me,oneshotQuestionInput:de,oneshotAnswerContainer:xe,oneshotAnalysisPanel:Se,oneshotSettingsSeparator:ge,settingsButton:Ce};function ve(){const[A,m]=n.useState(!1),[i,w]=n.useState(a.RetrieveThenRead),[d,B]=n.useState(""),[x,E]=n.useState(""),[S,I]=n.useState(""),[R,D]=n.useState(3),[g,O]=n.useState(!0),[_,Q]=n.useState(!1),[b,U]=n.useState(""),C=n.useRef(""),[v,j]=n.useState(!1),[l,y]=n.useState(),[c,F]=n.useState(),[k,P]=n.useState(),[p,r]=n.useState(void 0),f=async t=>{C.current=t,l&&y(void 0),j(!0),P(void 0),r(void 0);try{const s={question:t,approach:i,overrides:{promptTemplate:d.length===0?void 0:d,promptTemplatePrefix:x.length===0?void 0:x,promptTemplateSuffix:S.length===0?void 0:S,excludeCategory:b.length===0?void 0:b,top:R,semanticRanker:g,semanticCaptions:_}},Y=await ne(s);F(Y)}catch(s){y(s)}finally{j(!1)}},H=(t,s)=>{B(s||"")},L=(t,s)=>{E(s||"")},V=(t,s)=>{I(s||"")},q=(t,s)=>{D(parseInt(s||"3"))},G=(t,s)=>{w((s==null?void 0:s.key)||a.RetrieveThenRead)},K=(t,s)=>{O(!!s)},z=(t,s)=>{Q(!!s)},J=(t,s)=>{U(s||"")},M=t=>{f(t)},W=t=>{k===t&&p===h.CitationTab?r(void 0):(P(t),r(h.CitationTab))},T=t=>{r(p===t?void 0:t)},X=[{key:a.RetrieveThenRead,text:"Retrieve-Then-Read"},{key:a.ReadRetrieveRead,text:"Read-Retrieve-Read"},{key:a.ReadDecomposeAsk,text:"Read-Decompose-Ask"}];return e.jsxs("div",{className:o.oneshotContainer,children:[e.jsxs("div",{className:o.oneshotTopSection,children:[e.jsx(Z,{className:o.settingsButton,onClick:()=>m(!A)}),e.jsx("h1",{className:o.oneshotTitle,children:"Ask your data"}),e.jsx("div",{className:o.oneshotQuestionInput,children:e.jsx($,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:v,onSend:t=>f(t)})})]}),e.jsxs("div",{className:o.oneshotBottomSection,children:[v&&e.jsx(ae,{label:"Generating answer"}),!C.current&&e.jsx(ee,{onExampleClicked:M}),!v&&c&&!l&&e.jsx("div",{className:o.oneshotAnswerContainer,children:e.jsx(te,{answer:c,onCitationClicked:t=>W(t),onThoughtProcessClicked:()=>T(h.ThoughtProcessTab),onSupportingContentClicked:()=>T(h.SupportingContentTab)})}),l?e.jsx("div",{className:o.oneshotAnswerContainer,children:e.jsx(se,{error:l.toString(),onRetry:()=>f(C.current)})}):null,p&&c&&e.jsx(oe,{className:o.oneshotAnalysisPanel,activeCitation:k,onActiveTabChanged:t=>T(t),citationHeight:"600px",answer:c,activeTab:p})]}),e.jsxs(ie,{headerText:"Configure answer generation",isOpen:A,isBlocking:!1,onDismiss:()=>m(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(re,{onClick:()=>m(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(le,{className:o.oneshotSettingsSeparator,label:"Approach",options:X,defaultSelectedKey:i,onChange:G}),(i===a.RetrieveThenRead||i===a.ReadDecomposeAsk)&&e.jsx(u,{className:o.oneshotSettingsSeparator,defaultValue:d,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:H}),i===a.ReadRetrieveRead&&e.jsxs(e.Fragment,{children:[e.jsx(u,{className:o.oneshotSettingsSeparator,defaultValue:x,label:"Override prompt prefix template",multiline:!0,autoAdjustHeight:!0,onChange:L}),e.jsx(u,{className:o.oneshotSettingsSeparator,defaultValue:S,label:"Override prompt suffix template",multiline:!0,autoAdjustHeight:!0,onChange:V})]}),e.jsx(ce,{className:o.oneshotSettingsSeparator,label:"Retrieve this many documents from search:",min:1,max:50,defaultValue:R.toString(),onChange:q}),e.jsx(u,{className:o.oneshotSettingsSeparator,label:"Exclude category",onChange:J}),e.jsx(N,{className:o.oneshotSettingsSeparator,checked:g,label:"Use semantic ranker for retrieval",onChange:K}),e.jsx(N,{className:o.oneshotSettingsSeparator,checked:_,label:"Use query-contextual summaries instead of whole documents",onChange:z,disabled:!g})]})]})}ve.displayName="OneShot";export{ve as Component};
//# sourceMappingURL=OneShot-a43e1a47.js.map
